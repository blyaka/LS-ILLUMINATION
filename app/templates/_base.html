{% load static %}
{% load categories_tags %}


<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    {% block title %}
    <title>LS-ILLIMINATOIN</title>
    {% endblock title %}


    <link rel="stylesheet" href="{% static 'css/base.css' %}">


    {% block styles %}

    {% endblock styles %}

</head>

<body>

    <div id="bg-bubbles" aria-hidden="true"></div>

    <header class="ls-header">
        <div class="ls-header__inner">
            <a class="ls-logo" href="{% url 'home' %}">
                <img src="{% static 'images/logo.png' %}" alt="LS Illumination">
                <span class="ls-logo__brand">LS ILLUMINATION</span>
                <i class="ls-logo__sep"></i>
                <span class="ls-logo__ru">СВЕТОВЫЕ РЕШЕНИЯ</span>
            </a>

            <nav class="ls-nav">
                <a href="#" class="ls-nav__btn" id="pfOpen" aria-controls="pfPanel" role="button">Портфолио</a>
                <a href="#" id="ctOpen">Контакты</a>
                <a href="{% url 'about' %}">О нас</a>
            </nav>

            <a class="ls-cta" href="#" id="rqOpen">Оставить заявку</a>
        </div>
    </header>

    <div class="pf-underlay" id="pfUnderlay"></div>
    <section class="pf-panel" id="pfPanel" role="dialog" aria-modal="true">
        <div class="pf-panel__glass">
            <div class="pf-grid">
                {% for row in categories|chunk_categories %}
                <div class="pf-grid pf-grid--{{ row|length }}">
                    {% for cat in row %}
                    <a class="pf-card" href="{% url 'portfolio' slug=cat.slug %}">
                        {% if cat.icon.url %}<img src="{{ cat.icon.url }}" alt="{{ cat.name }}">{% endif %}
                        <span>{{ cat.name }}</span>
                    </a>
                    {% endfor %}
                </div>
                {% endfor %}
            </div>

            <div class="pf-grabber" aria-hidden="true"></div>
        </div>
    </section>





    {% block content %}

    {% endblock content %}


    <footer class="ls-footer">
        <a href="">Пользовательское соглашение</a>
        <a href="">Политика конфиденциальности</a>
        <a href="">© LS illumination, 2009-2025</a>
        <a href="">by</a>
    </footer>



    <div class="cookie-banner" id="cookieBanner" hidden>
        <div class="cookie-banner__wrap">
            <h3>Мы используем файлы cookie</h3>
            <p>
                Этот сайт применяет cookie-файлы и аналогичные технологии, чтобы обеспечить корректную работу,
                улучшить удобство использования, анализировать трафик и предлагать персонализированный контент.
                Подробнее — см. нашу <a href="/cookie-policy/" target="_blank">Политику использования файлов cookie</a>.
            </p>
            <div class="cookie-banner__actions">
                <button class="cookie-btn cookie-btn--decline" id="cookieDecline">Отклонить</button>
                <button class="cookie-btn cookie-btn--accept" id="cookieAccept">Принять все</button>
            </div>
        </div>
    </div>


    <script>
        (() => {
            const banner = document.getElementById('cookieBanner');
            const accept = document.getElementById('cookieAccept');
            const decline = document.getElementById('cookieDecline');

            if (!localStorage.getItem('cookieConsent')) {
                banner.hidden = false;
            }

            function setConsent(value) {
                localStorage.setItem('cookieConsent', value);
                banner.hidden = true;
            }

            accept.addEventListener('click', () => setConsent('accepted'));
            decline.addEventListener('click', () => setConsent('declined'));
        })();
    </script>





    <div class="rq-underlay" id="rqUnderlay" hidden></div>
    <section class="rq-modal" id="rqModal" role="dialog" aria-modal="true" aria-labelledby="rqTitle" hidden>
        <div class="rq-card">
            <button class="rq-close" type="button" id="rqClose" aria-label="Закрыть">×</button>
            <h2 class="rq-title" id="rqTitle">Напишите нам</h2>

            <form class="rq-form" method="post" action="{% url 'req_submit' %}">
                {% csrf_token %}
                <input type="hidden" name="hp" value="">
                <input type="hidden" name="ts" value="{{ now_ts|default:0 }}">

                <div class="rq-row rq-row--3">
                    <label class="rq-field">
                        <span>Ваше имя*</span>
                        <input type="text" name="name" id="rqName" required>
                    </label>
                    <label class="rq-field">
                        <span>Телефон*</span>
                        <input type="tel" name="phone" inputmode="tel" placeholder="+7" id="rqPhone" required>
                    </label>
                    <label class="rq-field">
                        <span>E-mail</span>
                        <input type="email" name="email">
                    </label>
                </div>

                <label class="rq-field rq-field--area">
                    <span>Сообщение</span>
                    <textarea name="message" rows="4"></textarea>
                </label>

                <div class="rq-bottom">
                    <label class="rq-check">
                        <input type="checkbox" required>
                        <i></i>
                        <span>Нажимая кнопку отправить, вы соглашаетесь с политикой обработки персональных данных</span>
                    </label>
                    <button class="rq-submit" type="submit">Отправить</button>
                </div>
            </form>
        </div>
    </section>


    <script>
        (() => {
        const nameInput = document.getElementById('rqName');
        const phoneInput = document.getElementById('rqPhone');

        nameInput.addEventListener('input', () => {
            nameInput.value = nameInput.value.replace(/[^a-zA-Zа-яА-ЯёЁ\s-]/g, '');
        });

        phoneInput.addEventListener('input', () => {
            let v = phoneInput.value.replace(/\D/g, '');
            if (!v) { phoneInput.value = ''; return; }

            if (v[0] === '7') {
            v = '7' + v.slice(1);
            phoneInput.value = format(v, true);
            } else if (v[0] === '8') {
            phoneInput.value = format(v, false);
            } else {
            phoneInput.value = format(v, true);
            }
        });

        function format(d, plus) {
            const p = d.padEnd(11, '_').slice(0, 11);
            const part1 = p.slice(1, 4);
            const part2 = p.slice(4, 7);
            const part3 = p.slice(7, 9);
            const part4 = p.slice(9, 11);

            return (plus ? '+7' : '8') +
            ` (${part1}) ${part2}-${part3}-${part4}`.replace(/[_-]+$/,'');
        }
        })();
    </script>


    <script>
        (function () {
            var ts = document.querySelector('form.rq-form input[name="ts"]');
            if (ts && (!ts.value || ts.value === "0")) ts.value = Math.floor(Date.now() / 1000);
        })();
    </script>

    <section class="rq-modal" id="ctModal" role="dialog" aria-modal="true" aria-labelledby="ctTitle" hidden>
        <div class="rq-card contacts-modal">
            <button class="rq-close" type="button" id="ctClose" aria-label="Закрыть">×</button>
            <h2 class="rq-title" id="ctTitle">Контакты</h2>

            <div class="ct-grid">
                <div class="ct-col">
                    <div class="ct-item">
                        <span class="ct-label">Телефон</span>
                        <div class="ct-val">+7 (812) 642-03-65</div>
                    </div>
                    <div class="ct-item">
                        <span class="ct-label">Адрес</span>
                        <div class="ct-val">г. Санкт-Петербург,<br>улица Ломоносова, 28</div>
                    </div>
                    <div class="ct-item">
                        <span class="ct-label">E-mail*</span>
                        <div class="ct-val"><a href="mailto:info@multidekor.ru">info@multidekor.ru</a></div>
                    </div>
                </div>

                <div class="ct-col">
                    <div class="ct-item">
                        <span class="ct-label">Время работы:</span>
                        <div class="ct-val">
                            Пн–Пт<br>с 10:00 до 18:00
                        </div>
                    </div>
                    <div class="ct-item">
                        <div class="ct-val" style="margin-top:16px">
                            Сб–Вс<br>Выходные дни
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>



    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const rqOpen = document.getElementById('rqOpen');
            const rqModal = document.getElementById('rqModal');
            const rqUnder = document.getElementById('rqUnderlay');
            const rqClose = document.getElementById('rqClose');

            const rqShow = () => {
                rqUnder.hidden = false; rqModal.hidden = false;
                rqModal.getBoundingClientRect();
                rqUnder.classList.add('show');
                rqModal.classList.add('show');
                document.documentElement.classList.add('rq-lock');
            };
            const rqHide = () => {
                rqUnder.classList.remove('show');
                rqModal.classList.remove('show');
                const done = () => { rqUnder.hidden = true; rqModal.hidden = true; rqModal.removeEventListener('transitionend', done); };
                rqModal.addEventListener('transitionend', done);
                document.documentElement.classList.remove('rq-lock');
            };

            rqOpen?.addEventListener('click', e => { e.preventDefault(); rqShow(); });
            rqClose?.addEventListener('click', rqHide);
            rqUnder?.addEventListener('click', rqHide);
            document.addEventListener('keydown', e => e.key === 'Escape' && rqModal.classList.contains('show') && rqHide());

            const pfOpen = document.getElementById('pfOpen');
            const pfPanel = document.getElementById('pfPanel');
            const pfUnder = document.getElementById('pfUnderlay');

            const pfShow = () => { pfUnder.classList.add('show'); pfPanel.getBoundingClientRect(); pfPanel.classList.add('show'); };
            const pfHide = () => { pfPanel.classList.remove('show'); pfUnder.classList.remove('show'); };

            pfOpen?.addEventListener('click', e => { e.preventDefault(); pfPanel.classList.contains('show') ? pfHide() : pfShow(); });
            pfUnder?.addEventListener('click', pfHide);
            document.addEventListener('keydown', e => e.key === 'Escape' && pfHide());

            const ctOpen = document.getElementById('ctOpen');
            const ctModal = document.getElementById('ctModal');
            const ctClose = document.getElementById('ctClose');
            const under = document.getElementById('rqUnderlay');

            const openCt = () => {
                under.hidden = false; ctModal.hidden = false;
                ctModal.getBoundingClientRect();
                under.classList.add('show');
                ctModal.classList.add('show');
                document.documentElement.classList.add('rq-lock');
            };
            const closeCt = () => {
                ctModal.classList.remove('show');
                under.classList.remove('show');
                const done = () => {
                    ctModal.hidden = true;
                    under.hidden = true;
                    ctModal.removeEventListener('transitionend', done);
                };
                ctModal.addEventListener('transitionend', done);
                document.documentElement.classList.remove('rq-lock');
            };

            ctOpen?.addEventListener('click', e => { e.preventDefault(); openCt(); });
            ctClose?.addEventListener('click', closeCt);
            under?.addEventListener('click', () => {
                if (ctModal.classList.contains('show')) closeCt();
                if (rqModal.classList.contains('show')) rqHide();
            });
            document.addEventListener('keydown', e => {
                if (e.key === 'Escape' && ctModal.classList.contains('show')) closeCt();
            });
        });
    </script>



<script>
(() => {
  const root = document.getElementById('bg-bubbles');
  if (!root) return;

  const DESIRED = 5;                 // всегда 5
  const MIN_D = 140, MAX_D = 240;    // диаметр
  const SEP_PAD = 32;                // зазор между шарами
  const MIN_V = 18,  MAX_V = 28;      // скорость (px/c)
  const SEP_K = 0.015;               // мягкое «разъезжание»
  const WANDER = 0.15;               // блуждание
  const OFF_SPAWN = 120;             // насколько за краём спавним
  const OFF_KILL  = 160;             // насколько далеко можно улететь до удаления

  let W = innerWidth, H = innerHeight;
  const rnd = (a,b)=>a+Math.random()*(b-a);
  const clamp=(v,a,b)=>Math.max(a,Math.min(b,v));
  const balls = [];

  function makeEl(d){
    const el = document.createElement('div');
    el.className = 'bg-bubble is-born';
    el.style.setProperty('--d', d+'px');
    root.appendChild(el);
    requestAnimationFrame(()=> el.classList.remove('is-born'));
    return el;
  }

  function spawnOutside(){
    const d = rnd(MIN_D, MAX_D), r = d/2;
    const side = Math.floor(rnd(0,4)); 
    let x,y;
    if (side===0){ x = -OFF_SPAWN - r; y = rnd(-OFF_SPAWN, H+OFF_SPAWN); }
    if (side===1){ x = W + OFF_SPAWN + r; y = rnd(-OFF_SPAWN, H+OFF_SPAWN); }
    if (side===2){ x = rnd(-OFF_SPAWN, W+OFF_SPAWN); y = -OFF_SPAWN - r; }
    if (side===3){ x = rnd(-OFF_SPAWN, W+OFF_SPAWN); y = H + OFF_SPAWN + r; }

    const tx = rnd(r+SEP_PAD, W - r - SEP_PAD);
    const ty = rnd(r+SEP_PAD, H - r - SEP_PAD);
    let vx = tx - x, vy = ty - y;
    const len = Math.hypot(vx,vy) || 1;
    const spd = rnd(MIN_V, MAX_V);
    vx = vx/len * spd; vy = vy/len * spd;

    const el = makeEl(d);
    const b = { el, r, x, y, vx, vy };
    balls.push(b);
  }

  function ensureCount(){
    while (balls.length < DESIRED) spawnOutside();
  }

  ensureCount();

  let t0 = performance.now();
  function tick(t1){
    ensureCount();

    const dt = (t1 - t0)/1000; t0 = t1;

    for (let i=0;i<balls.length;i++){
      const b = balls[i];

      let ax=(Math.random()-0.5)*WANDER, ay=(Math.random()-0.5)*WANDER;

      for (let j=i+1;j<balls.length;j++){
        const c = balls[j];
        const dx=b.x-c.x, dy=b.y-c.y;
        const dist = Math.hypot(dx,dy) || 0.001;
        const need = b.r + c.r + SEP_PAD;
        if (dist < need){
          const push = (need - dist) * SEP_K;
          const nx = dx/dist, ny = dy/dist;
          ax += nx*push; ay += ny*push;
          c.vx -= nx*push; c.vy -= ny*push;
        }
      }

      b.vx += ax; b.vy += ay;

      const sp = Math.hypot(b.vx,b.vy);
      const tgt = clamp(sp, MIN_V, MAX_V);
      if (sp>0.001){ b.vx = b.vx/sp*tgt; b.vy = b.vy/sp*tgt; }

      b.x += b.vx*dt; b.y += b.vy*dt;
      b.el.style.transform = `translate3d(${b.x - b.r}px, ${b.y - b.r}px, 0)`;
    }

    for (let i=balls.length-1;i>=0;i--){
      const b = balls[i];
      if (
        b.x + b.r < -OFF_KILL ||
        b.x - b.r > W + OFF_KILL ||
        b.y + b.r < -OFF_KILL ||
        b.y - b.r > H + OFF_KILL
      ){
        b.el.remove();
        balls.splice(i,1);
      }
    }

    requestAnimationFrame(tick);
  }
  requestAnimationFrame(tick);

  addEventListener('resize', () => { W = innerWidth; H = innerHeight; });
})();
</script>



</body>

</html>